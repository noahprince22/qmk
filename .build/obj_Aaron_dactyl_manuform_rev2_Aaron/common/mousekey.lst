   1               		.file	"mousekey.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.move_unit,"ax",@progbits
  12               	move_unit:
  13               	.LFB1:
  14               		.file 1 "./tmk_core/common/mousekey.c"
   1:./tmk_core/common/mousekey.c **** /*
   2:./tmk_core/common/mousekey.c **** Copyright 2011 Jun Wako <wakojun@gmail.com>
   3:./tmk_core/common/mousekey.c **** 
   4:./tmk_core/common/mousekey.c **** This program is free software: you can redistribute it and/or modify
   5:./tmk_core/common/mousekey.c **** it under the terms of the GNU General Public License as published by
   6:./tmk_core/common/mousekey.c **** the Free Software Foundation, either version 2 of the License, or
   7:./tmk_core/common/mousekey.c **** (at your option) any later version.
   8:./tmk_core/common/mousekey.c **** 
   9:./tmk_core/common/mousekey.c **** This program is distributed in the hope that it will be useful,
  10:./tmk_core/common/mousekey.c **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:./tmk_core/common/mousekey.c **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:./tmk_core/common/mousekey.c **** GNU General Public License for more details.
  13:./tmk_core/common/mousekey.c **** 
  14:./tmk_core/common/mousekey.c **** You should have received a copy of the GNU General Public License
  15:./tmk_core/common/mousekey.c **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:./tmk_core/common/mousekey.c **** */
  17:./tmk_core/common/mousekey.c **** 
  18:./tmk_core/common/mousekey.c **** #include <stdint.h>
  19:./tmk_core/common/mousekey.c **** #include "keycode.h"
  20:./tmk_core/common/mousekey.c **** #include "host.h"
  21:./tmk_core/common/mousekey.c **** #include "timer.h"
  22:./tmk_core/common/mousekey.c **** #include "print.h"
  23:./tmk_core/common/mousekey.c **** #include "debug.h"
  24:./tmk_core/common/mousekey.c **** #include "mousekey.h"
  25:./tmk_core/common/mousekey.c **** 
  26:./tmk_core/common/mousekey.c **** 
  27:./tmk_core/common/mousekey.c **** 
  28:./tmk_core/common/mousekey.c **** static report_mouse_t mouse_report = {};
  29:./tmk_core/common/mousekey.c **** static uint8_t mousekey_repeat =  0;
  30:./tmk_core/common/mousekey.c **** static uint8_t mousekey_accel = 0;
  31:./tmk_core/common/mousekey.c **** 
  32:./tmk_core/common/mousekey.c **** static void mousekey_debug(void);
  33:./tmk_core/common/mousekey.c **** 
  34:./tmk_core/common/mousekey.c **** 
  35:./tmk_core/common/mousekey.c **** /*
  36:./tmk_core/common/mousekey.c ****  * Mouse keys  acceleration algorithm
  37:./tmk_core/common/mousekey.c ****  *  http://en.wikipedia.org/wiki/Mouse_keys
  38:./tmk_core/common/mousekey.c ****  *
  39:./tmk_core/common/mousekey.c ****  *  speed = delta * max_speed * (repeat / time_to_max)**((1000+curve)/1000)
  40:./tmk_core/common/mousekey.c ****  */
  41:./tmk_core/common/mousekey.c **** /* milliseconds between the initial key press and first repeated motion event (0-2550) */
  42:./tmk_core/common/mousekey.c **** uint8_t mk_delay = MOUSEKEY_DELAY/10;
  43:./tmk_core/common/mousekey.c **** /* milliseconds between repeated motion events (0-255) */
  44:./tmk_core/common/mousekey.c **** uint8_t mk_interval = MOUSEKEY_INTERVAL;
  45:./tmk_core/common/mousekey.c **** /* steady speed (in action_delta units) applied each event (0-255) */
  46:./tmk_core/common/mousekey.c **** uint8_t mk_max_speed = MOUSEKEY_MAX_SPEED;
  47:./tmk_core/common/mousekey.c **** /* number of events (count) accelerating to steady speed (0-255) */
  48:./tmk_core/common/mousekey.c **** uint8_t mk_time_to_max = MOUSEKEY_TIME_TO_MAX;
  49:./tmk_core/common/mousekey.c **** /* ramp used to reach maximum pointer speed (NOT SUPPORTED) */
  50:./tmk_core/common/mousekey.c **** //int8_t mk_curve = 0;
  51:./tmk_core/common/mousekey.c **** /* wheel params */
  52:./tmk_core/common/mousekey.c **** uint8_t mk_wheel_max_speed = MOUSEKEY_WHEEL_MAX_SPEED;
  53:./tmk_core/common/mousekey.c **** uint8_t mk_wheel_time_to_max = MOUSEKEY_WHEEL_TIME_TO_MAX;
  54:./tmk_core/common/mousekey.c **** 
  55:./tmk_core/common/mousekey.c **** 
  56:./tmk_core/common/mousekey.c **** static uint16_t last_timer = 0;
  57:./tmk_core/common/mousekey.c **** 
  58:./tmk_core/common/mousekey.c **** inline int8_t times_inv_sqrt2(int8_t x)
  59:./tmk_core/common/mousekey.c **** {
  60:./tmk_core/common/mousekey.c ****     // 181/256 is pretty close to 1/sqrt(2)
  61:./tmk_core/common/mousekey.c ****     // 0.70703125                 0.707106781
  62:./tmk_core/common/mousekey.c ****     // 1 too small for x=99 and x=198
  63:./tmk_core/common/mousekey.c ****     // This ends up being a mult and discard lower 8 bits
  64:./tmk_core/common/mousekey.c ****     return (x * 181) >> 8;
  65:./tmk_core/common/mousekey.c **** }
  66:./tmk_core/common/mousekey.c **** 
  67:./tmk_core/common/mousekey.c **** static uint8_t move_unit(void)
  68:./tmk_core/common/mousekey.c **** {
  15               		.loc 1 68 0
  16               		.cfi_startproc
  17               	/* prologue: function */
  18               	/* frame size = 0 */
  19               	/* stack size = 0 */
  20               	.L__stack_usage = 0
  69:./tmk_core/common/mousekey.c ****     uint16_t unit;
  70:./tmk_core/common/mousekey.c ****     if (mousekey_accel & (1<<0)) {
  21               		.loc 1 70 0
  22 0000 8091 0000 		lds r24,mousekey_accel
  23 0004 80FF      		sbrs r24,0
  24 0006 00C0      		rjmp .L2
  71:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed)/4;
  25               		.loc 1 71 0
  26 0008 6091 0000 		lds r22,mk_max_speed
  27 000c 85E0      		ldi r24,lo8(5)
  28 000e 689F      		mul r22,r24
  29 0010 B001      		movw r22,r0
  30 0012 1124      		clr __zero_reg__
  31 0014 7595      		asr r23
  32 0016 6795      		ror r22
  33 0018 7595      		asr r23
  34 001a 6795      		ror r22
  35               	.LVL0:
  36 001c 00C0      		rjmp .L3
  37               	.LVL1:
  38               	.L2:
  72:./tmk_core/common/mousekey.c ****     } else if (mousekey_accel & (1<<1)) {
  39               		.loc 1 72 0
  40 001e 81FF      		sbrs r24,1
  41 0020 00C0      		rjmp .L4
  73:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed)/2;
  42               		.loc 1 73 0
  43 0022 6091 0000 		lds r22,mk_max_speed
  44 0026 85E0      		ldi r24,lo8(5)
  45 0028 689F      		mul r22,r24
  46 002a B001      		movw r22,r0
  47 002c 1124      		clr __zero_reg__
  48 002e 7595      		asr r23
  49 0030 6795      		ror r22
  50               	.LVL2:
  51 0032 00C0      		rjmp .L3
  52               	.LVL3:
  53               	.L4:
  74:./tmk_core/common/mousekey.c ****     } else if (mousekey_accel & (1<<2)) {
  54               		.loc 1 74 0
  55 0034 82FF      		sbrs r24,2
  56 0036 00C0      		rjmp .L5
  57               	.L7:
  75:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed);
  58               		.loc 1 75 0
  59 0038 6091 0000 		lds r22,mk_max_speed
  60 003c 85E0      		ldi r24,lo8(5)
  61 003e 689F      		mul r22,r24
  62 0040 B001      		movw r22,r0
  63 0042 1124      		clr __zero_reg__
  64               	.LVL4:
  65 0044 00C0      		rjmp .L3
  66               	.LVL5:
  67               	.L5:
  76:./tmk_core/common/mousekey.c ****     } else if (mousekey_repeat == 0) {
  68               		.loc 1 76 0
  69 0046 4091 0000 		lds r20,mousekey_repeat
  70 004a 4423      		tst r20
  71 004c 01F0      		breq .L9
  77:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
  78:./tmk_core/common/mousekey.c ****     } else if (mousekey_repeat >= mk_time_to_max) {
  72               		.loc 1 78 0
  73 004e 6091 0000 		lds r22,mk_time_to_max
  74 0052 4617      		cp r20,r22
  75 0054 00F4      		brsh .L7
  79:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA * mk_max_speed;
  80:./tmk_core/common/mousekey.c ****     } else {
  81:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_MOVE_DELTA * mk_max_speed * mousekey_repeat) / mk_time_to_max;
  76               		.loc 1 81 0
  77 0056 2091 0000 		lds r18,mk_max_speed
  78 005a 85E0      		ldi r24,lo8(5)
  79 005c 289F      		mul r18,r24
  80 005e 9001      		movw r18,r0
  81 0060 1124      		clr __zero_reg__
  82 0062 429F      		mul r20,r18
  83 0064 C001      		movw r24,r0
  84 0066 439F      		mul r20,r19
  85 0068 900D      		add r25,r0
  86 006a 1124      		clr __zero_reg__
  87 006c 70E0      		ldi r23,0
  88 006e 0E94 0000 		call __divmodhi4
  89               	.LVL6:
  90               	.L3:
  82:./tmk_core/common/mousekey.c ****     }
  83:./tmk_core/common/mousekey.c ****     return (unit > MOUSEKEY_MOVE_MAX ? MOUSEKEY_MOVE_MAX : (unit == 0 ? 1 : unit));
  91               		.loc 1 83 0
  92 0072 6038      		cpi r22,-128
  93 0074 7105      		cpc r23,__zero_reg__
  94 0076 00F4      		brsh .L10
  95               		.loc 1 83 0 is_stmt 0 discriminator 1
  96 0078 6115      		cp r22,__zero_reg__
  97 007a 7105      		cpc r23,__zero_reg__
  98 007c 01F0      		breq .L11
  99 007e 00C0      		rjmp .L6
 100               	.LVL7:
 101               	.L9:
  77:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_MOVE_DELTA;
 102               		.loc 1 77 0 is_stmt 1
 103 0080 65E0      		ldi r22,lo8(5)
 104 0082 70E0      		ldi r23,0
 105               	.L6:
 106               		.loc 1 83 0 discriminator 3
 107 0084 862F      		mov r24,r22
 108 0086 0895      		ret
 109               	.LVL8:
 110               	.L10:
 111               		.loc 1 83 0 is_stmt 0
 112 0088 8FE7      		ldi r24,lo8(127)
 113 008a 0895      		ret
 114               	.L11:
 115 008c 81E0      		ldi r24,lo8(1)
  84:./tmk_core/common/mousekey.c **** }
 116               		.loc 1 84 0 is_stmt 1
 117 008e 0895      		ret
 118               		.cfi_endproc
 119               	.LFE1:
 121               		.section	.text.wheel_unit,"ax",@progbits
 123               	wheel_unit:
 124               	.LFB2:
  85:./tmk_core/common/mousekey.c **** 
  86:./tmk_core/common/mousekey.c **** static uint8_t wheel_unit(void)
  87:./tmk_core/common/mousekey.c **** {
 125               		.loc 1 87 0
 126               		.cfi_startproc
 127               	/* prologue: function */
 128               	/* frame size = 0 */
 129               	/* stack size = 0 */
 130               	.L__stack_usage = 0
  88:./tmk_core/common/mousekey.c ****     uint16_t unit;
  89:./tmk_core/common/mousekey.c ****     if (mousekey_accel & (1<<0)) {
 131               		.loc 1 89 0
 132 0000 8091 0000 		lds r24,mousekey_accel
 133 0004 80FF      		sbrs r24,0
 134 0006 00C0      		rjmp .L14
  90:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed)/4;
 135               		.loc 1 90 0
 136 0008 6091 0000 		lds r22,mk_wheel_max_speed
 137 000c 70E0      		ldi r23,0
 138 000e 7595      		asr r23
 139 0010 6795      		ror r22
 140 0012 7595      		asr r23
 141 0014 6795      		ror r22
 142               	.LVL9:
 143 0016 00C0      		rjmp .L21
 144               	.LVL10:
 145               	.L14:
  91:./tmk_core/common/mousekey.c ****     } else if (mousekey_accel & (1<<1)) {
 146               		.loc 1 91 0
 147 0018 81FF      		sbrs r24,1
 148 001a 00C0      		rjmp .L16
  92:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed)/2;
 149               		.loc 1 92 0
 150 001c 6091 0000 		lds r22,mk_wheel_max_speed
 151 0020 70E0      		ldi r23,0
 152 0022 7595      		asr r23
 153 0024 6795      		ror r22
 154               	.LVL11:
 155 0026 00C0      		rjmp .L21
 156               	.LVL12:
 157               	.L16:
  93:./tmk_core/common/mousekey.c ****     } else if (mousekey_accel & (1<<2)) {
 158               		.loc 1 93 0
 159 0028 82FF      		sbrs r24,2
 160 002a 00C0      		rjmp .L17
 161               	.L19:
  94:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed);
 162               		.loc 1 94 0
 163 002c 6091 0000 		lds r22,mk_wheel_max_speed
 164 0030 70E0      		ldi r23,0
 165               	.LVL13:
 166 0032 00C0      		rjmp .L18
 167               	.LVL14:
 168               	.L17:
  95:./tmk_core/common/mousekey.c ****     } else if (mousekey_repeat == 0) {
 169               		.loc 1 95 0
 170 0034 8091 0000 		lds r24,mousekey_repeat
 171 0038 8823      		tst r24
 172 003a 01F0      		breq .L22
  96:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
  97:./tmk_core/common/mousekey.c ****     } else if (mousekey_repeat >= mk_wheel_time_to_max) {
 173               		.loc 1 97 0
 174 003c 6091 0000 		lds r22,mk_wheel_time_to_max
 175 0040 8617      		cp r24,r22
 176 0042 00F4      		brsh .L19
  98:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed;
  99:./tmk_core/common/mousekey.c ****     } else {
 100:./tmk_core/common/mousekey.c ****         unit = (MOUSEKEY_WHEEL_DELTA * mk_wheel_max_speed * mousekey_repeat) / mk_wheel_time_to_max
 177               		.loc 1 100 0
 178 0044 9091 0000 		lds r25,mk_wheel_max_speed
 179 0048 989F      		mul r25,r24
 180 004a C001      		movw r24,r0
 181 004c 1124      		clr __zero_reg__
 182 004e 70E0      		ldi r23,0
 183 0050 0E94 0000 		call __divmodhi4
 184               	.LVL15:
 185               	.L18:
 101:./tmk_core/common/mousekey.c ****     }
 102:./tmk_core/common/mousekey.c ****     return (unit > MOUSEKEY_WHEEL_MAX ? MOUSEKEY_WHEEL_MAX : (unit == 0 ? 1 : unit));
 186               		.loc 1 102 0
 187 0054 6038      		cpi r22,-128
 188 0056 7105      		cpc r23,__zero_reg__
 189 0058 00F4      		brsh .L23
 190               	.LVL16:
 191               	.L21:
 192               		.loc 1 102 0 is_stmt 0 discriminator 1
 193 005a 6115      		cp r22,__zero_reg__
 194 005c 7105      		cpc r23,__zero_reg__
 195 005e 01F0      		breq .L24
 196               		.loc 1 102 0 discriminator 3
 197 0060 862F      		mov r24,r22
 198 0062 0895      		ret
 199               	.L23:
 200               		.loc 1 102 0
 201 0064 8FE7      		ldi r24,lo8(127)
 202 0066 0895      		ret
 203               	.L24:
 204 0068 81E0      		ldi r24,lo8(1)
 205 006a 0895      		ret
 206               	.LVL17:
 207               	.L22:
  96:./tmk_core/common/mousekey.c ****         unit = MOUSEKEY_WHEEL_DELTA;
 208               		.loc 1 96 0 is_stmt 1
 209 006c 61E0      		ldi r22,lo8(1)
 210 006e 70E0      		ldi r23,0
 211               	.LVL18:
 212 0070 00C0      		rjmp .L21
 213               		.cfi_endproc
 214               	.LFE2:
 216               		.section	.text.mousekey_on,"ax",@progbits
 217               	.global	mousekey_on
 219               	mousekey_on:
 220               	.LFB4:
 103:./tmk_core/common/mousekey.c **** }
 104:./tmk_core/common/mousekey.c **** 
 105:./tmk_core/common/mousekey.c **** void mousekey_task(void)
 106:./tmk_core/common/mousekey.c **** {
 107:./tmk_core/common/mousekey.c ****     if (timer_elapsed(last_timer) < (mousekey_repeat ? mk_interval : mk_delay*10))
 108:./tmk_core/common/mousekey.c ****         return;
 109:./tmk_core/common/mousekey.c **** 
 110:./tmk_core/common/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0 && mouse_report.v == 0 && mouse_report.h == 0)
 111:./tmk_core/common/mousekey.c ****         return;
 112:./tmk_core/common/mousekey.c **** 
 113:./tmk_core/common/mousekey.c ****     if (mousekey_repeat != UINT8_MAX)
 114:./tmk_core/common/mousekey.c ****         mousekey_repeat++;
 115:./tmk_core/common/mousekey.c **** 
 116:./tmk_core/common/mousekey.c **** 
 117:./tmk_core/common/mousekey.c ****     if (mouse_report.x > 0) mouse_report.x = move_unit();
 118:./tmk_core/common/mousekey.c ****     if (mouse_report.x < 0) mouse_report.x = move_unit() * -1;
 119:./tmk_core/common/mousekey.c ****     if (mouse_report.y > 0) mouse_report.y = move_unit();
 120:./tmk_core/common/mousekey.c ****     if (mouse_report.y < 0) mouse_report.y = move_unit() * -1;
 121:./tmk_core/common/mousekey.c **** 
 122:./tmk_core/common/mousekey.c ****     /* diagonal move [1/sqrt(2)] */
 123:./tmk_core/common/mousekey.c ****     if (mouse_report.x && mouse_report.y) {
 124:./tmk_core/common/mousekey.c ****         mouse_report.x = times_inv_sqrt2(mouse_report.x);
 125:./tmk_core/common/mousekey.c ****         mouse_report.y = times_inv_sqrt2(mouse_report.y);
 126:./tmk_core/common/mousekey.c ****     }
 127:./tmk_core/common/mousekey.c **** 
 128:./tmk_core/common/mousekey.c ****     if (mouse_report.v > 0) mouse_report.v = wheel_unit();
 129:./tmk_core/common/mousekey.c ****     if (mouse_report.v < 0) mouse_report.v = wheel_unit() * -1;
 130:./tmk_core/common/mousekey.c ****     if (mouse_report.h > 0) mouse_report.h = wheel_unit();
 131:./tmk_core/common/mousekey.c ****     if (mouse_report.h < 0) mouse_report.h = wheel_unit() * -1;
 132:./tmk_core/common/mousekey.c **** 
 133:./tmk_core/common/mousekey.c ****     mousekey_send();
 134:./tmk_core/common/mousekey.c **** }
 135:./tmk_core/common/mousekey.c **** 
 136:./tmk_core/common/mousekey.c **** void mousekey_on(uint8_t code)
 137:./tmk_core/common/mousekey.c **** {
 221               		.loc 1 137 0
 222               		.cfi_startproc
 223               	.LVL19:
 224               	/* prologue: function */
 225               	/* frame size = 0 */
 226               	/* stack size = 0 */
 227               	.L__stack_usage = 0
 138:./tmk_core/common/mousekey.c ****     if      (code == KC_MS_UP)       mouse_report.y = move_unit() * -1;
 228               		.loc 1 138 0
 229 0000 803F      		cpi r24,lo8(-16)
 230 0002 01F4      		brne .L27
 231               		.loc 1 138 0 is_stmt 0 discriminator 1
 232 0004 0E94 0000 		call move_unit
 233               	.LVL20:
 234 0008 8195      		neg r24
 235 000a 00C0      		rjmp .L43
 236               	.LVL21:
 237               	.L27:
 139:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_DOWN)     mouse_report.y = move_unit();
 238               		.loc 1 139 0 is_stmt 1
 239 000c 813F      		cpi r24,lo8(-15)
 240 000e 01F4      		brne .L29
 241               		.loc 1 139 0 is_stmt 0 discriminator 1
 242 0010 0E94 0000 		call move_unit
 243               	.LVL22:
 244               	.L43:
 245 0014 8093 0000 		sts mouse_report+2,r24
 246 0018 0895      		ret
 247               	.LVL23:
 248               	.L29:
 140:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_LEFT)     mouse_report.x = move_unit() * -1;
 249               		.loc 1 140 0 is_stmt 1
 250 001a 823F      		cpi r24,lo8(-14)
 251 001c 01F4      		brne .L30
 252               		.loc 1 140 0 is_stmt 0 discriminator 1
 253 001e 0E94 0000 		call move_unit
 254               	.LVL24:
 255 0022 8195      		neg r24
 256 0024 00C0      		rjmp .L45
 257               	.LVL25:
 258               	.L30:
 141:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_RIGHT)    mouse_report.x = move_unit();
 259               		.loc 1 141 0 is_stmt 1
 260 0026 833F      		cpi r24,lo8(-13)
 261 0028 01F4      		brne .L31
 262               		.loc 1 141 0 is_stmt 0 discriminator 1
 263 002a 0E94 0000 		call move_unit
 264               	.LVL26:
 265               	.L45:
 266 002e 8093 0000 		sts mouse_report+1,r24
 267 0032 0895      		ret
 268               	.LVL27:
 269               	.L31:
 142:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_UP)    mouse_report.v = wheel_unit();
 270               		.loc 1 142 0 is_stmt 1
 271 0034 893F      		cpi r24,lo8(-7)
 272 0036 01F4      		brne .L32
 273               		.loc 1 142 0 is_stmt 0 discriminator 1
 274 0038 0E94 0000 		call wheel_unit
 275               	.LVL28:
 276 003c 00C0      		rjmp .L47
 277               	.LVL29:
 278               	.L32:
 143:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_DOWN)  mouse_report.v = wheel_unit() * -1;
 279               		.loc 1 143 0 is_stmt 1
 280 003e 8A3F      		cpi r24,lo8(-6)
 281 0040 01F4      		brne .L33
 282               		.loc 1 143 0 is_stmt 0 discriminator 1
 283 0042 0E94 0000 		call wheel_unit
 284               	.LVL30:
 285 0046 8195      		neg r24
 286               	.L47:
 287 0048 8093 0000 		sts mouse_report+3,r24
 288 004c 0895      		ret
 289               	.LVL31:
 290               	.L33:
 144:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_LEFT)  mouse_report.h = wheel_unit() * -1;
 291               		.loc 1 144 0 is_stmt 1
 292 004e 8B3F      		cpi r24,lo8(-5)
 293 0050 01F4      		brne .L34
 294               		.loc 1 144 0 is_stmt 0 discriminator 1
 295 0052 0E94 0000 		call wheel_unit
 296               	.LVL32:
 297 0056 8195      		neg r24
 298 0058 00C0      		rjmp .L48
 299               	.LVL33:
 300               	.L34:
 145:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_RIGHT) mouse_report.h = wheel_unit();
 301               		.loc 1 145 0 is_stmt 1
 302 005a 8C3F      		cpi r24,lo8(-4)
 303 005c 01F4      		brne .L35
 304               		.loc 1 145 0 is_stmt 0 discriminator 1
 305 005e 0E94 0000 		call wheel_unit
 306               	.LVL34:
 307               	.L48:
 308 0062 8093 0000 		sts mouse_report+4,r24
 309 0066 0895      		ret
 310               	.LVL35:
 311               	.L35:
 146:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN1)     mouse_report.buttons |= MOUSE_BTN1;
 312               		.loc 1 146 0 is_stmt 1
 313 0068 843F      		cpi r24,lo8(-12)
 314 006a 01F4      		brne .L36
 315               		.loc 1 146 0 is_stmt 0 discriminator 1
 316 006c 8091 0000 		lds r24,mouse_report
 317               	.LVL36:
 318 0070 8160      		ori r24,lo8(1)
 319 0072 00C0      		rjmp .L46
 320               	.LVL37:
 321               	.L36:
 147:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN2)     mouse_report.buttons |= MOUSE_BTN2;
 322               		.loc 1 147 0 is_stmt 1
 323 0074 853F      		cpi r24,lo8(-11)
 324 0076 01F4      		brne .L37
 325               		.loc 1 147 0 is_stmt 0 discriminator 1
 326 0078 8091 0000 		lds r24,mouse_report
 327               	.LVL38:
 328 007c 8260      		ori r24,lo8(2)
 329 007e 00C0      		rjmp .L46
 330               	.LVL39:
 331               	.L37:
 148:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN3)     mouse_report.buttons |= MOUSE_BTN3;
 332               		.loc 1 148 0 is_stmt 1
 333 0080 863F      		cpi r24,lo8(-10)
 334 0082 01F4      		brne .L38
 335               		.loc 1 148 0 is_stmt 0 discriminator 1
 336 0084 8091 0000 		lds r24,mouse_report
 337               	.LVL40:
 338 0088 8460      		ori r24,lo8(4)
 339 008a 00C0      		rjmp .L46
 340               	.LVL41:
 341               	.L38:
 149:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN4)     mouse_report.buttons |= MOUSE_BTN4;
 342               		.loc 1 149 0 is_stmt 1
 343 008c 873F      		cpi r24,lo8(-9)
 344 008e 01F4      		brne .L39
 345               		.loc 1 149 0 is_stmt 0 discriminator 1
 346 0090 8091 0000 		lds r24,mouse_report
 347               	.LVL42:
 348 0094 8860      		ori r24,lo8(8)
 349 0096 00C0      		rjmp .L46
 350               	.LVL43:
 351               	.L39:
 150:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN5)     mouse_report.buttons |= MOUSE_BTN5;
 352               		.loc 1 150 0 is_stmt 1
 353 0098 883F      		cpi r24,lo8(-8)
 354 009a 01F4      		brne .L40
 355               		.loc 1 150 0 is_stmt 0 discriminator 1
 356 009c 8091 0000 		lds r24,mouse_report
 357               	.LVL44:
 358 00a0 8061      		ori r24,lo8(16)
 359               	.L46:
 360 00a2 8093 0000 		sts mouse_report,r24
 361 00a6 0895      		ret
 362               	.LVL45:
 363               	.L40:
 151:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL0)   mousekey_accel |= (1<<0);
 364               		.loc 1 151 0 is_stmt 1
 365 00a8 8D3F      		cpi r24,lo8(-3)
 366 00aa 01F4      		brne .L41
 367               		.loc 1 151 0 is_stmt 0 discriminator 1
 368 00ac 8091 0000 		lds r24,mousekey_accel
 369               	.LVL46:
 370 00b0 8160      		ori r24,lo8(1)
 371 00b2 00C0      		rjmp .L44
 372               	.LVL47:
 373               	.L41:
 152:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL1)   mousekey_accel |= (1<<1);
 374               		.loc 1 152 0 is_stmt 1
 375 00b4 8E3F      		cpi r24,lo8(-2)
 376 00b6 01F4      		brne .L42
 377               		.loc 1 152 0 is_stmt 0 discriminator 1
 378 00b8 8091 0000 		lds r24,mousekey_accel
 379               	.LVL48:
 380 00bc 8260      		ori r24,lo8(2)
 381 00be 00C0      		rjmp .L44
 382               	.LVL49:
 383               	.L42:
 153:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL2)   mousekey_accel |= (1<<2);
 384               		.loc 1 153 0 is_stmt 1
 385 00c0 8F3F      		cpi r24,lo8(-1)
 386 00c2 01F4      		brne .L26
 387               		.loc 1 153 0 is_stmt 0 discriminator 1
 388 00c4 8091 0000 		lds r24,mousekey_accel
 389               	.LVL50:
 390 00c8 8460      		ori r24,lo8(4)
 391               	.L44:
 392 00ca 8093 0000 		sts mousekey_accel,r24
 393               	.L26:
 394 00ce 0895      		ret
 395               		.cfi_endproc
 396               	.LFE4:
 398               		.section	.text.mousekey_off,"ax",@progbits
 399               	.global	mousekey_off
 401               	mousekey_off:
 402               	.LFB5:
 154:./tmk_core/common/mousekey.c **** }
 155:./tmk_core/common/mousekey.c **** 
 156:./tmk_core/common/mousekey.c **** void mousekey_off(uint8_t code)
 157:./tmk_core/common/mousekey.c **** {
 403               		.loc 1 157 0 is_stmt 1
 404               		.cfi_startproc
 405               	.LVL51:
 406               	/* prologue: function */
 407               	/* frame size = 0 */
 408               	/* stack size = 0 */
 409               	.L__stack_usage = 0
 158:./tmk_core/common/mousekey.c ****     if      (code == KC_MS_UP       && mouse_report.y < 0) mouse_report.y = 0;
 410               		.loc 1 158 0
 411 0000 803F      		cpi r24,lo8(-16)
 412 0002 01F4      		brne .L50
 413               		.loc 1 158 0 is_stmt 0 discriminator 1
 414 0004 8091 0000 		lds r24,mouse_report+2
 415               	.LVL52:
 416 0008 87FF      		sbrs r24,7
 417 000a 00C0      		rjmp .L52
 418               	.L54:
 419 000c 1092 0000 		sts mouse_report+2,__zero_reg__
 420 0010 00C0      		rjmp .L52
 421               	.LVL53:
 422               	.L50:
 159:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_DOWN     && mouse_report.y > 0) mouse_report.y = 0;
 423               		.loc 1 159 0 is_stmt 1
 424 0012 813F      		cpi r24,lo8(-15)
 425 0014 01F4      		brne .L53
 426               		.loc 1 159 0 is_stmt 0 discriminator 1
 427 0016 8091 0000 		lds r24,mouse_report+2
 428               	.LVL54:
 429 001a 1816      		cp __zero_reg__,r24
 430 001c 04F0      		brlt .L54
 431 001e 00C0      		rjmp .L52
 432               	.LVL55:
 433               	.L53:
 434 0020 9091 0000 		lds r25,mouse_report+1
 160:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_LEFT     && mouse_report.x < 0) mouse_report.x = 0;
 435               		.loc 1 160 0 is_stmt 1
 436 0024 823F      		cpi r24,lo8(-14)
 437 0026 01F4      		brne .L55
 438               		.loc 1 160 0 is_stmt 0 discriminator 1
 439 0028 97FF      		sbrs r25,7
 440 002a 00C0      		rjmp .L52
 441               	.L58:
 442 002c 1092 0000 		sts mouse_report+1,__zero_reg__
 443 0030 00C0      		rjmp .L52
 444               	.L55:
 161:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_RIGHT    && mouse_report.x > 0) mouse_report.x = 0;
 445               		.loc 1 161 0 is_stmt 1
 446 0032 833F      		cpi r24,lo8(-13)
 447 0034 01F4      		brne .L57
 448               		.loc 1 161 0 is_stmt 0 discriminator 1
 449 0036 1916      		cp __zero_reg__,r25
 450 0038 04F0      		brlt .L58
 451 003a 00C0      		rjmp .L52
 452               	.L57:
 162:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_UP    && mouse_report.v > 0) mouse_report.v = 0;
 453               		.loc 1 162 0 is_stmt 1
 454 003c 893F      		cpi r24,lo8(-7)
 455 003e 01F4      		brne .L51
 456               		.loc 1 162 0 is_stmt 0 discriminator 1
 457 0040 8091 0000 		lds r24,mouse_report+3
 458               	.LVL56:
 459 0044 1816      		cp __zero_reg__,r24
 460 0046 04F0      		brlt .+2
 461 0048 00C0      		rjmp .L52
 462               	.L62:
 463 004a 1092 0000 		sts mouse_report+3,__zero_reg__
 464 004e 00C0      		rjmp .L52
 465               	.LVL57:
 466               	.L51:
 163:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_DOWN  && mouse_report.v < 0) mouse_report.v = 0;
 467               		.loc 1 163 0 is_stmt 1
 468 0050 8A3F      		cpi r24,lo8(-6)
 469 0052 01F4      		brne .L61
 470               		.loc 1 163 0 is_stmt 0 discriminator 1
 471 0054 8091 0000 		lds r24,mouse_report+3
 472               	.LVL58:
 473 0058 87FF      		sbrs r24,7
 474 005a 00C0      		rjmp .L52
 475 005c 00C0      		rjmp .L62
 476               	.LVL59:
 477               	.L61:
 164:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_LEFT  && mouse_report.h < 0) mouse_report.h = 0;
 478               		.loc 1 164 0 is_stmt 1
 479 005e 8B3F      		cpi r24,lo8(-5)
 480 0060 01F4      		brne .L56
 481               		.loc 1 164 0 is_stmt 0 discriminator 1
 482 0062 8091 0000 		lds r24,mouse_report+4
 483               	.LVL60:
 484 0066 87FF      		sbrs r24,7
 485 0068 00C0      		rjmp .L52
 486               	.L64:
 487 006a 1092 0000 		sts mouse_report+4,__zero_reg__
 488 006e 00C0      		rjmp .L52
 489               	.LVL61:
 490               	.L56:
 165:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_WH_RIGHT && mouse_report.h > 0) mouse_report.h = 0;
 491               		.loc 1 165 0 is_stmt 1
 492 0070 8C3F      		cpi r24,lo8(-4)
 493 0072 01F4      		brne .L59
 494               		.loc 1 165 0 is_stmt 0 discriminator 1
 495 0074 8091 0000 		lds r24,mouse_report+4
 496               	.LVL62:
 497 0078 1816      		cp __zero_reg__,r24
 498 007a 04F0      		brlt .L64
 499 007c 00C0      		rjmp .L52
 500               	.LVL63:
 501               	.L59:
 166:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN1) mouse_report.buttons &= ~MOUSE_BTN1;
 502               		.loc 1 166 0 is_stmt 1
 503 007e 843F      		cpi r24,lo8(-12)
 504 0080 01F4      		brne .L60
 505               		.loc 1 166 0 is_stmt 0 discriminator 1
 506 0082 8091 0000 		lds r24,mouse_report
 507               	.LVL64:
 508 0086 8E7F      		andi r24,lo8(-2)
 509 0088 00C0      		rjmp .L72
 510               	.LVL65:
 511               	.L60:
 167:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN2) mouse_report.buttons &= ~MOUSE_BTN2;
 512               		.loc 1 167 0 is_stmt 1
 513 008a 853F      		cpi r24,lo8(-11)
 514 008c 01F4      		brne .L63
 515               		.loc 1 167 0 is_stmt 0 discriminator 1
 516 008e 8091 0000 		lds r24,mouse_report
 517               	.LVL66:
 518 0092 8D7F      		andi r24,lo8(-3)
 519 0094 00C0      		rjmp .L72
 520               	.LVL67:
 521               	.L63:
 168:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN3) mouse_report.buttons &= ~MOUSE_BTN3;
 522               		.loc 1 168 0 is_stmt 1
 523 0096 863F      		cpi r24,lo8(-10)
 524 0098 01F4      		brne .L65
 525               		.loc 1 168 0 is_stmt 0 discriminator 1
 526 009a 8091 0000 		lds r24,mouse_report
 527               	.LVL68:
 528 009e 8B7F      		andi r24,lo8(-5)
 529 00a0 00C0      		rjmp .L72
 530               	.LVL69:
 531               	.L65:
 169:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN4) mouse_report.buttons &= ~MOUSE_BTN4;
 532               		.loc 1 169 0 is_stmt 1
 533 00a2 873F      		cpi r24,lo8(-9)
 534 00a4 01F4      		brne .L66
 535               		.loc 1 169 0 is_stmt 0 discriminator 1
 536 00a6 8091 0000 		lds r24,mouse_report
 537               	.LVL70:
 538 00aa 877F      		andi r24,lo8(-9)
 539 00ac 00C0      		rjmp .L72
 540               	.LVL71:
 541               	.L66:
 170:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_BTN5) mouse_report.buttons &= ~MOUSE_BTN5;
 542               		.loc 1 170 0 is_stmt 1
 543 00ae 883F      		cpi r24,lo8(-8)
 544 00b0 01F4      		brne .L67
 545               		.loc 1 170 0 is_stmt 0 discriminator 1
 546 00b2 8091 0000 		lds r24,mouse_report
 547               	.LVL72:
 548 00b6 8F7E      		andi r24,lo8(-17)
 549               	.L72:
 550 00b8 8093 0000 		sts mouse_report,r24
 551 00bc 00C0      		rjmp .L52
 552               	.LVL73:
 553               	.L67:
 171:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL0) mousekey_accel &= ~(1<<0);
 554               		.loc 1 171 0 is_stmt 1
 555 00be 8D3F      		cpi r24,lo8(-3)
 556 00c0 01F4      		brne .L68
 557               		.loc 1 171 0 is_stmt 0 discriminator 1
 558 00c2 8091 0000 		lds r24,mousekey_accel
 559               	.LVL74:
 560 00c6 8E7F      		andi r24,lo8(-2)
 561 00c8 00C0      		rjmp .L71
 562               	.LVL75:
 563               	.L68:
 172:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL1) mousekey_accel &= ~(1<<1);
 564               		.loc 1 172 0 is_stmt 1
 565 00ca 8E3F      		cpi r24,lo8(-2)
 566 00cc 01F4      		brne .L69
 567               		.loc 1 172 0 is_stmt 0 discriminator 1
 568 00ce 8091 0000 		lds r24,mousekey_accel
 569               	.LVL76:
 570 00d2 8D7F      		andi r24,lo8(-3)
 571 00d4 00C0      		rjmp .L71
 572               	.LVL77:
 573               	.L69:
 173:./tmk_core/common/mousekey.c ****     else if (code == KC_MS_ACCEL2) mousekey_accel &= ~(1<<2);
 574               		.loc 1 173 0 is_stmt 1
 575 00d6 8F3F      		cpi r24,lo8(-1)
 576 00d8 01F4      		brne .L52
 577               		.loc 1 173 0 is_stmt 0 discriminator 1
 578 00da 8091 0000 		lds r24,mousekey_accel
 579               	.LVL78:
 580 00de 8B7F      		andi r24,lo8(-5)
 581               	.L71:
 582 00e0 8093 0000 		sts mousekey_accel,r24
 583               	.L52:
 174:./tmk_core/common/mousekey.c **** 
 175:./tmk_core/common/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0 && mouse_report.v == 0 && mouse_report.h == 0)
 584               		.loc 1 175 0 is_stmt 1
 585 00e4 8091 0000 		lds r24,mouse_report+1
 586 00e8 8111      		cpse r24,__zero_reg__
 587 00ea 00C0      		rjmp .L49
 588               		.loc 1 175 0 is_stmt 0 discriminator 1
 589 00ec 8091 0000 		lds r24,mouse_report+2
 590 00f0 8111      		cpse r24,__zero_reg__
 591 00f2 00C0      		rjmp .L49
 592 00f4 8091 0000 		lds r24,mouse_report+3
 593 00f8 8111      		cpse r24,__zero_reg__
 594 00fa 00C0      		rjmp .L49
 595 00fc 8091 0000 		lds r24,mouse_report+4
 596 0100 8111      		cpse r24,__zero_reg__
 597 0102 00C0      		rjmp .L49
 176:./tmk_core/common/mousekey.c ****         mousekey_repeat = 0;
 598               		.loc 1 176 0 is_stmt 1
 599 0104 1092 0000 		sts mousekey_repeat,__zero_reg__
 600               	.L49:
 601 0108 0895      		ret
 602               		.cfi_endproc
 603               	.LFE5:
 605               		.section	.text.mousekey_send,"ax",@progbits
 606               	.global	mousekey_send
 608               	mousekey_send:
 609               	.LFB6:
 177:./tmk_core/common/mousekey.c **** }
 178:./tmk_core/common/mousekey.c **** 
 179:./tmk_core/common/mousekey.c **** void mousekey_send(void)
 180:./tmk_core/common/mousekey.c **** {
 610               		.loc 1 180 0
 611               		.cfi_startproc
 612               	/* prologue: function */
 613               	/* frame size = 0 */
 614               	/* stack size = 0 */
 615               	.L__stack_usage = 0
 181:./tmk_core/common/mousekey.c ****     mousekey_debug();
 182:./tmk_core/common/mousekey.c ****     host_mouse_send(&mouse_report);
 616               		.loc 1 182 0
 617 0000 80E0      		ldi r24,lo8(mouse_report)
 618 0002 90E0      		ldi r25,hi8(mouse_report)
 619 0004 0E94 0000 		call host_mouse_send
 620               	.LVL79:
 183:./tmk_core/common/mousekey.c ****     last_timer = timer_read();
 621               		.loc 1 183 0
 622 0008 0E94 0000 		call timer_read
 623               	.LVL80:
 624 000c 9093 0000 		sts last_timer+1,r25
 625 0010 8093 0000 		sts last_timer,r24
 626 0014 0895      		ret
 627               		.cfi_endproc
 628               	.LFE6:
 630               		.section	.text.mousekey_task,"ax",@progbits
 631               	.global	mousekey_task
 633               	mousekey_task:
 634               	.LFB3:
 106:./tmk_core/common/mousekey.c **** {
 635               		.loc 1 106 0
 636               		.cfi_startproc
 637 0000 1F93      		push r17
 638               	.LCFI0:
 639               		.cfi_def_cfa_offset 3
 640               		.cfi_offset 17, -2
 641 0002 CF93      		push r28
 642               	.LCFI1:
 643               		.cfi_def_cfa_offset 4
 644               		.cfi_offset 28, -3
 645 0004 DF93      		push r29
 646               	.LCFI2:
 647               		.cfi_def_cfa_offset 5
 648               		.cfi_offset 29, -4
 649               	/* prologue: function */
 650               	/* frame size = 0 */
 651               	/* stack size = 3 */
 652               	.L__stack_usage = 3
 107:./tmk_core/common/mousekey.c ****     if (timer_elapsed(last_timer) < (mousekey_repeat ? mk_interval : mk_delay*10))
 653               		.loc 1 107 0
 654 0006 8091 0000 		lds r24,last_timer
 655 000a 9091 0000 		lds r25,last_timer+1
 656 000e 0E94 0000 		call timer_elapsed
 657               	.LVL81:
 658 0012 4091 0000 		lds r20,mousekey_repeat
 659 0016 4423      		tst r20
 660 0018 01F0      		breq .L75
 107:./tmk_core/common/mousekey.c ****     if (timer_elapsed(last_timer) < (mousekey_repeat ? mk_interval : mk_delay*10))
 661               		.loc 1 107 0 is_stmt 0 discriminator 1
 662 001a 2091 0000 		lds r18,mk_interval
 663 001e 30E0      		ldi r19,0
 664 0020 00C0      		rjmp .L76
 665               	.L75:
 107:./tmk_core/common/mousekey.c ****     if (timer_elapsed(last_timer) < (mousekey_repeat ? mk_interval : mk_delay*10))
 666               		.loc 1 107 0 discriminator 2
 667 0022 2091 0000 		lds r18,mk_delay
 668 0026 5AE0      		ldi r21,lo8(10)
 669 0028 259F      		mul r18,r21
 670 002a 9001      		movw r18,r0
 671 002c 1124      		clr __zero_reg__
 672               	.L76:
 107:./tmk_core/common/mousekey.c ****     if (timer_elapsed(last_timer) < (mousekey_repeat ? mk_interval : mk_delay*10))
 673               		.loc 1 107 0 discriminator 3
 674 002e 8217      		cp r24,r18
 675 0030 9307      		cpc r25,r19
 676 0032 00F4      		brsh .+2
 677 0034 00C0      		rjmp .L74
 110:./tmk_core/common/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0 && mouse_report.v == 0 && mouse_report.h == 0)
 678               		.loc 1 110 0 is_stmt 1
 679 0036 8091 0000 		lds r24,mouse_report+1
 680 003a 1091 0000 		lds r17,mouse_report+2
 681 003e D091 0000 		lds r29,mouse_report+3
 682 0042 C091 0000 		lds r28,mouse_report+4
 683 0046 8111      		cpse r24,__zero_reg__
 684 0048 00C0      		rjmp .L78
 110:./tmk_core/common/mousekey.c ****     if (mouse_report.x == 0 && mouse_report.y == 0 && mouse_report.v == 0 && mouse_report.h == 0)
 685               		.loc 1 110 0 is_stmt 0 discriminator 1
 686 004a 1111      		cpse r17,__zero_reg__
 687 004c 00C0      		rjmp .L78
 688 004e D111      		cpse r29,__zero_reg__
 689 0050 00C0      		rjmp .L78
 690 0052 CC23      		tst r28
 691 0054 01F4      		brne .+2
 692 0056 00C0      		rjmp .L74
 693               	.L78:
 113:./tmk_core/common/mousekey.c ****     if (mousekey_repeat != UINT8_MAX)
 694               		.loc 1 113 0 is_stmt 1
 695 0058 4F3F      		cpi r20,lo8(-1)
 696 005a 01F0      		breq .L79
 114:./tmk_core/common/mousekey.c ****         mousekey_repeat++;
 697               		.loc 1 114 0
 698 005c 4F5F      		subi r20,lo8(-(1))
 699 005e 4093 0000 		sts mousekey_repeat,r20
 700               	.L79:
 117:./tmk_core/common/mousekey.c ****     if (mouse_report.x > 0) mouse_report.x = move_unit();
 701               		.loc 1 117 0
 702 0062 1816      		cp __zero_reg__,r24
 703 0064 04F4      		brge .L80
 117:./tmk_core/common/mousekey.c ****     if (mouse_report.x > 0) mouse_report.x = move_unit();
 704               		.loc 1 117 0 is_stmt 0 discriminator 1
 705 0066 0E94 0000 		call move_unit
 706               	.LVL82:
 707 006a 8093 0000 		sts mouse_report+1,r24
 708               	.L80:
 118:./tmk_core/common/mousekey.c ****     if (mouse_report.x < 0) mouse_report.x = move_unit() * -1;
 709               		.loc 1 118 0 is_stmt 1
 710 006e 8091 0000 		lds r24,mouse_report+1
 711 0072 87FF      		sbrs r24,7
 712 0074 00C0      		rjmp .L81
 118:./tmk_core/common/mousekey.c ****     if (mouse_report.x < 0) mouse_report.x = move_unit() * -1;
 713               		.loc 1 118 0 is_stmt 0 discriminator 1
 714 0076 0E94 0000 		call move_unit
 715               	.LVL83:
 716 007a 8195      		neg r24
 717 007c 8093 0000 		sts mouse_report+1,r24
 718               	.L81:
 119:./tmk_core/common/mousekey.c ****     if (mouse_report.y > 0) mouse_report.y = move_unit();
 719               		.loc 1 119 0 is_stmt 1
 720 0080 1116      		cp __zero_reg__,r17
 721 0082 04F4      		brge .L82
 119:./tmk_core/common/mousekey.c ****     if (mouse_report.y > 0) mouse_report.y = move_unit();
 722               		.loc 1 119 0 is_stmt 0 discriminator 1
 723 0084 0E94 0000 		call move_unit
 724               	.LVL84:
 725 0088 8093 0000 		sts mouse_report+2,r24
 726               	.L82:
 120:./tmk_core/common/mousekey.c ****     if (mouse_report.y < 0) mouse_report.y = move_unit() * -1;
 727               		.loc 1 120 0 is_stmt 1
 728 008c 8091 0000 		lds r24,mouse_report+2
 729 0090 87FF      		sbrs r24,7
 730 0092 00C0      		rjmp .L83
 120:./tmk_core/common/mousekey.c ****     if (mouse_report.y < 0) mouse_report.y = move_unit() * -1;
 731               		.loc 1 120 0 is_stmt 0 discriminator 1
 732 0094 0E94 0000 		call move_unit
 733               	.LVL85:
 734 0098 8195      		neg r24
 735 009a 8093 0000 		sts mouse_report+2,r24
 736               	.L83:
 123:./tmk_core/common/mousekey.c ****     if (mouse_report.x && mouse_report.y) {
 737               		.loc 1 123 0 is_stmt 1
 738 009e 2091 0000 		lds r18,mouse_report+1
 739 00a2 2223      		tst r18
 740 00a4 01F0      		breq .L84
 123:./tmk_core/common/mousekey.c ****     if (mouse_report.x && mouse_report.y) {
 741               		.loc 1 123 0 is_stmt 0 discriminator 1
 742 00a6 4091 0000 		lds r20,mouse_report+2
 743 00aa 4423      		tst r20
 744 00ac 01F0      		breq .L84
 745               	.LVL86:
 746               	.LBB6:
 747               	.LBB7:
  64:./tmk_core/common/mousekey.c ****     return (x * 181) >> 8;
 748               		.loc 1 64 0 is_stmt 1
 749 00ae 55EB      		ldi r21,lo8(-75)
 750 00b0 2503      		mulsu r18,r21
 751 00b2 9001      		movw r18,r0
 752 00b4 1124      		clr __zero_reg__
 753               	.LVL87:
 754 00b6 3093 0000 		sts mouse_report+1,r19
 755               	.LVL88:
 756               	.LBE7:
 757               	.LBE6:
 758               	.LBB8:
 759               	.LBB9:
 760 00ba 4503      		mulsu r20,r21
 761 00bc C001      		movw r24,r0
 762 00be 1124      		clr __zero_reg__
 763 00c0 9093 0000 		sts mouse_report+2,r25
 764               	.LVL89:
 765               	.L84:
 766               	.LBE9:
 767               	.LBE8:
 128:./tmk_core/common/mousekey.c ****     if (mouse_report.v > 0) mouse_report.v = wheel_unit();
 768               		.loc 1 128 0
 769 00c4 1D16      		cp __zero_reg__,r29
 770 00c6 04F4      		brge .L85
 128:./tmk_core/common/mousekey.c ****     if (mouse_report.v > 0) mouse_report.v = wheel_unit();
 771               		.loc 1 128 0 is_stmt 0 discriminator 1
 772 00c8 0E94 0000 		call wheel_unit
 773               	.LVL90:
 774 00cc 8093 0000 		sts mouse_report+3,r24
 775               	.L85:
 129:./tmk_core/common/mousekey.c ****     if (mouse_report.v < 0) mouse_report.v = wheel_unit() * -1;
 776               		.loc 1 129 0 is_stmt 1
 777 00d0 8091 0000 		lds r24,mouse_report+3
 778 00d4 87FF      		sbrs r24,7
 779 00d6 00C0      		rjmp .L86
 129:./tmk_core/common/mousekey.c ****     if (mouse_report.v < 0) mouse_report.v = wheel_unit() * -1;
 780               		.loc 1 129 0 is_stmt 0 discriminator 1
 781 00d8 0E94 0000 		call wheel_unit
 782               	.LVL91:
 783 00dc 8195      		neg r24
 784 00de 8093 0000 		sts mouse_report+3,r24
 785               	.L86:
 130:./tmk_core/common/mousekey.c ****     if (mouse_report.h > 0) mouse_report.h = wheel_unit();
 786               		.loc 1 130 0 is_stmt 1
 787 00e2 1C16      		cp __zero_reg__,r28
 788 00e4 04F4      		brge .L87
 130:./tmk_core/common/mousekey.c ****     if (mouse_report.h > 0) mouse_report.h = wheel_unit();
 789               		.loc 1 130 0 is_stmt 0 discriminator 1
 790 00e6 0E94 0000 		call wheel_unit
 791               	.LVL92:
 792 00ea 8093 0000 		sts mouse_report+4,r24
 793               	.L87:
 131:./tmk_core/common/mousekey.c ****     if (mouse_report.h < 0) mouse_report.h = wheel_unit() * -1;
 794               		.loc 1 131 0 is_stmt 1
 795 00ee 8091 0000 		lds r24,mouse_report+4
 796 00f2 87FF      		sbrs r24,7
 797 00f4 00C0      		rjmp .L88
 131:./tmk_core/common/mousekey.c ****     if (mouse_report.h < 0) mouse_report.h = wheel_unit() * -1;
 798               		.loc 1 131 0 is_stmt 0 discriminator 1
 799 00f6 0E94 0000 		call wheel_unit
 800               	.LVL93:
 801 00fa 8195      		neg r24
 802 00fc 8093 0000 		sts mouse_report+4,r24
 803               	.L88:
 804               	/* epilogue start */
 134:./tmk_core/common/mousekey.c **** }
 805               		.loc 1 134 0 is_stmt 1
 806 0100 DF91      		pop r29
 807 0102 CF91      		pop r28
 808 0104 1F91      		pop r17
 133:./tmk_core/common/mousekey.c ****     mousekey_send();
 809               		.loc 1 133 0
 810 0106 0C94 0000 		jmp mousekey_send
 811               	.LVL94:
 812               	.L74:
 813               	/* epilogue start */
 134:./tmk_core/common/mousekey.c **** }
 814               		.loc 1 134 0
 815 010a DF91      		pop r29
 816 010c CF91      		pop r28
 817 010e 1F91      		pop r17
 818 0110 0895      		ret
 819               		.cfi_endproc
 820               	.LFE3:
 822               		.section	.text.mousekey_clear,"ax",@progbits
 823               	.global	mousekey_clear
 825               	mousekey_clear:
 826               	.LFB7:
 184:./tmk_core/common/mousekey.c **** }
 185:./tmk_core/common/mousekey.c **** 
 186:./tmk_core/common/mousekey.c **** void mousekey_clear(void)
 187:./tmk_core/common/mousekey.c **** {
 827               		.loc 1 187 0
 828               		.cfi_startproc
 829               	/* prologue: function */
 830               	/* frame size = 0 */
 831               	/* stack size = 0 */
 832               	.L__stack_usage = 0
 188:./tmk_core/common/mousekey.c ****     mouse_report = (report_mouse_t){};
 833               		.loc 1 188 0
 834 0000 E0E0      		ldi r30,lo8(mouse_report)
 835 0002 F0E0      		ldi r31,hi8(mouse_report)
 836 0004 85E0      		ldi r24,lo8(5)
 837 0006 DF01      		movw r26,r30
 838               		0:
 839 0008 1D92      		st X+,__zero_reg__
 840 000a 8A95      		dec r24
 841 000c 01F4      		brne 0b
 189:./tmk_core/common/mousekey.c ****     mousekey_repeat = 0;
 842               		.loc 1 189 0
 843 000e 1092 0000 		sts mousekey_repeat,__zero_reg__
 190:./tmk_core/common/mousekey.c ****     mousekey_accel = 0;
 844               		.loc 1 190 0
 845 0012 1092 0000 		sts mousekey_accel,__zero_reg__
 846 0016 0895      		ret
 847               		.cfi_endproc
 848               	.LFE7:
 850               		.section	.bss.last_timer,"aw",@nobits
 853               	last_timer:
 854 0000 0000      		.zero	2
 855               	.global	mk_wheel_time_to_max
 856               		.section	.data.mk_wheel_time_to_max,"aw",@progbits
 859               	mk_wheel_time_to_max:
 860 0000 28        		.byte	40
 861               	.global	mk_wheel_max_speed
 862               		.section	.data.mk_wheel_max_speed,"aw",@progbits
 865               	mk_wheel_max_speed:
 866 0000 08        		.byte	8
 867               	.global	mk_time_to_max
 868               		.section	.data.mk_time_to_max,"aw",@progbits
 871               	mk_time_to_max:
 872 0000 14        		.byte	20
 873               	.global	mk_max_speed
 874               		.section	.data.mk_max_speed,"aw",@progbits
 877               	mk_max_speed:
 878 0000 0A        		.byte	10
 879               	.global	mk_interval
 880               		.section	.data.mk_interval,"aw",@progbits
 883               	mk_interval:
 884 0000 32        		.byte	50
 885               	.global	mk_delay
 886               		.section	.data.mk_delay,"aw",@progbits
 889               	mk_delay:
 890 0000 1E        		.byte	30
 891               		.section	.bss.mousekey_accel,"aw",@nobits
 894               	mousekey_accel:
 895 0000 00        		.zero	1
 896               		.section	.bss.mousekey_repeat,"aw",@nobits
 899               	mousekey_repeat:
 900 0000 00        		.zero	1
 901               		.section	.bss.mouse_report,"aw",@nobits
 904               	mouse_report:
 905 0000 0000 0000 		.zero	5
 905      00
 906               		.text
 907               	.Letext0:
 908               		.file 2 "/usr/lib/avr/include/stdint.h"
 909               		.file 3 "./tmk_core/common/report.h"
 910               		.file 4 "./tmk_core/common/debug.h"
 911               		.file 5 "./tmk_core/common/host.h"
 912               		.file 6 "./tmk_core/common/timer.h"
 913               		.file 7 "./tmk_core/common/keycode.h"
DEFINED SYMBOLS
                            *ABS*:0000000000000000 mousekey.c
     /tmp/cciuanms.s:2      *ABS*:000000000000003e __SP_H__
     /tmp/cciuanms.s:3      *ABS*:000000000000003d __SP_L__
     /tmp/cciuanms.s:4      *ABS*:000000000000003f __SREG__
     /tmp/cciuanms.s:5      *ABS*:0000000000000000 __tmp_reg__
     /tmp/cciuanms.s:6      *ABS*:0000000000000001 __zero_reg__
     /tmp/cciuanms.s:12     .text.move_unit:0000000000000000 move_unit
     /tmp/cciuanms.s:894    .bss.mousekey_accel:0000000000000000 mousekey_accel
     /tmp/cciuanms.s:877    .data.mk_max_speed:0000000000000000 mk_max_speed
     /tmp/cciuanms.s:899    .bss.mousekey_repeat:0000000000000000 mousekey_repeat
     /tmp/cciuanms.s:871    .data.mk_time_to_max:0000000000000000 mk_time_to_max
     /tmp/cciuanms.s:123    .text.wheel_unit:0000000000000000 wheel_unit
     /tmp/cciuanms.s:865    .data.mk_wheel_max_speed:0000000000000000 mk_wheel_max_speed
     /tmp/cciuanms.s:859    .data.mk_wheel_time_to_max:0000000000000000 mk_wheel_time_to_max
     /tmp/cciuanms.s:219    .text.mousekey_on:0000000000000000 mousekey_on
     /tmp/cciuanms.s:904    .bss.mouse_report:0000000000000000 mouse_report
     /tmp/cciuanms.s:401    .text.mousekey_off:0000000000000000 mousekey_off
     /tmp/cciuanms.s:608    .text.mousekey_send:0000000000000000 mousekey_send
     /tmp/cciuanms.s:853    .bss.last_timer:0000000000000000 last_timer
     /tmp/cciuanms.s:633    .text.mousekey_task:0000000000000000 mousekey_task
     /tmp/cciuanms.s:883    .data.mk_interval:0000000000000000 mk_interval
     /tmp/cciuanms.s:889    .data.mk_delay:0000000000000000 mk_delay
     /tmp/cciuanms.s:825    .text.mousekey_clear:0000000000000000 mousekey_clear

UNDEFINED SYMBOLS
__divmodhi4
host_mouse_send
timer_read
timer_elapsed
__do_copy_data
__do_clear_bss
